const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CzgetsJO.js","assets/crypto-vendor-C-h6Caw_.js"])))=>i.map(i=>d[i]);
import{_ as w}from"./index-BjUtlDQ4.js";import{N as b,a as d,_}from"./utils-BribboEG.js";import{c as p,h as f,o as y,d as e,w as k,u as A,x as S,t as v}from"./vue-vendor-T9dwXKqP.js";const j={name:"AuthorizationModal",props:{show:{type:Boolean,required:!0}},emits:["close","authorized"],components:{NotificationMessage:b},data(){return{password:"",isAuthorizing:!1}},methods:{async authorize(){if(!this.isAuthorizing){this.isAuthorizing=!0;try{const l=await w(()=>import("./index-CzgetsJO.js").then(a=>a.i),__vite__mapDeps([0,1])),t="asmmRrfFvKrsBgyLzUuiZD9tGQj3LAQj",c=1e5,u=256/32;if(l.PBKDF2(this.password,t,{keySize:u,iterations:c}).toString()!=="5fb04c8d929f687dd2baed132f66d67a8a442cab4d2d84cec4a58b08f01f9c6b"){d("Nieprawidłowe hasło","red"),this.password="",this.isAuthorizing=!1;return}const s={};for(let a=0;a<localStorage.length;a++){const r=localStorage.key(a);if(r!=="isEditingMode"&&r!=="currentPage")try{s[r]=JSON.parse(localStorage.getItem(r))}catch{}}if(Object.keys(s).length===0){d("Brak zmian do zapisania","yellow"),this.isAuthorizing=!1;return}const m=JSON.stringify(s),z=new Blob([m],{type:"application/json"}),n=new FileReader,g=await new Promise((a,r)=>{n.onloadend=()=>a(n.result.toString().split(",")[1]),n.onerror=r,n.readAsDataURL(z)}),h=await fetch("https://mc.kot.li/?key=shiftData.json",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"shiftData",value:g})});if(!h.ok)throw new Error(`Server error: ${h.status}`);d("Zmiany zapisano pomyślnie!","green"),this.$emit("authorized"),this.closeModal()}catch{d("Nie udało się zaktualizować danych","red")}finally{this.isAuthorizing=!1}}},closeModal(){this.password="",this.$emit("close")},cancel(){this.isAuthorizing||this.closeModal()}},mounted(){this.$nextTick(()=>{this.$refs.passwordInput?.focus()})}},D={key:0,class:"modal"},N={class:"modal-content"},B={class:"input-container"},M={class:"button-container"},x=["disabled"],K={key:0,class:"spinner"},P=["disabled"];function C(l,t,c,u,o,i){return c.show?(y(),p("section",D,[e("div",N,[t[4]||(t[4]=e("h3",null,"Autoryzacja",-1)),t[5]||(t[5]=e("p",null,"Wpisz hasło aby zapisać zmiany:",-1)),e("div",B,[k(e("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=s=>o.password=s),onKeyup:t[1]||(t[1]=S((...s)=>i.authorize&&i.authorize(...s),["enter"])),placeholder:"Hasło...",autocomplete:"current-password",ref:"passwordInput"},null,544),[[A,o.password]])]),e("div",M,[e("button",{class:"primary-button",onClick:t[2]||(t[2]=(...s)=>i.authorize&&i.authorize(...s)),disabled:o.isAuthorizing},[e("span",null,v(o.isAuthorizing?"Weryfikacja...":"Zapisz"),1),o.isAuthorizing?(y(),p("span",K)):f("",!0)],8,x),e("button",{class:"secondary-button",onClick:t[3]||(t[3]=(...s)=>i.cancel&&i.cancel(...s)),disabled:o.isAuthorizing}," Anuluj ",8,P)])])])):f("",!0)}const T=_(j,[["render",C],["__scopeId","data-v-610e794d"]]);export{T as default};
