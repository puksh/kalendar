const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-BF0zIuxs.js","assets/crypto-vendor-x_riFVyO.js","assets/SideBarComponent-DTaVJZrM.js","assets/utils-B-gdOSXq.js","assets/vue-vendor-wnm_OC9P.js","assets/utils-BWm1wYfN.css","assets/SideBarComponent-DPivk8FM.css","assets/MonthSelector-B_LtiwB7.js","assets/MonthSelector-DXdWr8Vr.css","assets/PeopleListWindow-DacT2nIH.js","assets/PeopleListWindow-BxO8ts3g.css","assets/ShiftCountWindow-CaJ_Rlsh.js","assets/ShiftCountWindow-CqDjm859.css","assets/CalendarComponent-C89GBL2m.js","assets/daysOfWeek-C19XqJ9X.js","assets/CalendarComponent-DmWScBV4.css","assets/ExcelComponent-CO52EKUP.js","assets/ExcelComponent-BF8ecqC9.css","assets/AuthorizationModal-B-Jb3w7K.js","assets/AuthorizationModal-BiYznelC.css"])))=>i.map(i=>d[i]);
import{c as w,o as g,d as i,e as E,n as T,f as B,w as O,t as P,F as L,a as j,g as z,h as x,i as N,j as b,k as W,l as U,m as H,v as Y,b as I,p as F,q as Z}from"./vue-vendor-wnm_OC9P.js";import{_ as R,a as C,c as q}from"./utils-B-gdOSXq.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();const K="modulepreload",J=function(t){return"/"+t},V={},v=function(e,o,a){let s=Promise.resolve();if(o&&o.length>0){let r=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),p=l?.nonce||l?.getAttribute("nonce");s=r(o.map(c=>{if(c=J(c),c in V)return;V[c]=!0;const u=c.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${y}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":K,u||(f.as="script"),f.crossOrigin="",f.href=c,p&&f.setAttribute("nonce",p),document.head.appendChild(f),u)return new Promise((D,d)=>{f.addEventListener("load",D),f.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return s.then(r=>{for(const l of r||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})},G={},X={class:"refresh-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"};function Q(t,e){return g(),w("svg",X,e[0]||(e[0]=[i("path",{d:"M23 4v6h-6"},null,-1),i("path",{d:"M1 20v-6h6"},null,-1),i("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10"},null,-1),i("path",{d:"M20.49 15a9 9 0 0 1-14.85 3.36L1 14"},null,-1)]))}const $=R(G,[["render",Q],["__scopeId","data-v-11885e2d"]]);function ee(t){const e=[{date:new Date(t,0,1),name:"Nowy Rok"},{date:new Date(t,0,6),name:"Święto Trzech Króli"},{date:new Date(t,4,1),name:"Święto Pracy"},{date:new Date(t,4,3),name:"Święto Konstytucji 3 Maja"},{date:new Date(t,7,15),name:"Wniebowzięcie Najświętszej Maryi Panny"},{date:new Date(t,10,1),name:"Wszystkich Świętych"},{date:new Date(t,10,11),name:"Święto Niepodległości"},{date:new Date(t,11,25),name:"Boże Narodzenie (pierwszy dzień)"},{date:new Date(t,11,26),name:"Boże Narodzenie (drugi dzień)"}],o=te(t);e.push({date:o,name:"Wielkanoc"});const a=new Date(o);a.setDate(o.getDate()+1),e.push({date:a,name:"Poniedziałek Wielkanocny"});const s=new Date(o);s.setDate(o.getDate()+49),e.push({date:s,name:"Zielone Świątki"});const n=new Date(o);return n.setDate(o.getDate()+60),e.push({date:n,name:"Boże Ciało"}),e}function te(t){const e=t%19,o=Math.floor(t/100),a=t%100,s=Math.floor(o/4),n=o%4,r=Math.floor((o+8)/25),l=Math.floor((o-r+1)/3),p=(19*e+o-s-l+15)%30,c=Math.floor(a/4),u=a%4,y=(32+2*n+2*c-p-u)%7,f=Math.floor((e+11*p+22*y)/451),D=Math.floor((p+y-7*f+114)/31)-1,d=(p+y-7*f+114)%31+1;return new Date(t,D,d)}function S(t){const e=ee(t.getFullYear());for(const o of e)if(o.date.getDate()===t.getDate()&&o.date.getMonth()===t.getMonth()&&o.date.getFullYear()===t.getFullYear())return{isHoliday:!0,name:o.name};return{isHoliday:!1}}const oe={name:"ButtonExport",props:{people:{type:Array,required:!0},monthDays:{type:Array,required:!0},selectedMonth:{type:Number,required:!0},selectedYear:{type:Number,required:!0},currentPage:{type:String,default:"ExcelComponent"}},data(){return{showExportMenu:!1}},mounted(){document.addEventListener("click",this.handleOutsideClick)},beforeUnmount(){document.removeEventListener("click",this.handleOutsideClick)},methods:{toggleExportMenu(t){t.stopPropagation(),this.showExportMenu=!this.showExportMenu},handleOutsideClick(t){this.showExportMenu&&!t.target.closest(".export-container")&&(this.showExportMenu=!1)},getMonthName(){return["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"][this.selectedMonth]},getFilename(t){return`Harmonogram_${this.getMonthName()}_${this.selectedYear}.${t}`},exportToCsv(){let t="\uFEFF";t+="Imię";for(let o=1;o<=this.getDaysInMonth();o++)t+=`;${o}`;t+=`\r
`;for(const o of this.people){t+=`"${o.name}"`;for(let a=1;a<=this.getDaysInMonth();a++)t+=`;${this.getFormattedShift(o.id,a," ")||""}`;t+=`\r
`}const e=new Blob([t],{type:"text/csv;charset=utf-8"});this.downloadFile(e,this.getFilename("csv")),this.showExportMenu=!1},async exportToPdf(){try{const{jsPDF:t}=await v(async()=>{const{jsPDF:d}=await import("./jspdf.es.min-gV6Nqxvy.js").then(h=>h.j);return{jsPDF:d}},[]),{autoTable:e}=await v(async()=>{const{autoTable:d}=await import("./jspdf.plugin.autotable-BgrBGiiK.js");return{autoTable:d}},[]),o=new t({orientation:"landscape",unit:"mm",format:"a4"});try{const d=await fetch("/assets/fonts/IBMPlexMono-Regular.ttf");if(!d.ok)throw new Error("Font file not found");const h=await d.arrayBuffer();o.addFileToVFS("IBMPlexMono-Regular.ttf",this.arrayBufferToBase64(h)),o.addFont("IBMPlexMono-Regular.ttf","IBMPlexMono","normal"),o.setFont("IBMPlexMono")}catch(d){console.warn("Could not load local font, using fallback",d),o.setFont("helvetica")}let a=o.internal.pageSize.getWidth();o.setFontSize(16),o.setTextColor(0,0,0);const s="IZBA PRZYJĘĆ DZIECIĘCA",n=o.getStringUnitWidth(s)*o.getFontSize()/o.internal.scaleFactor;o.text(s,(a-n)/2,15);const l="ROZKŁAD PRACY PRACOWNIKÓW KONTRAKTOWYCH - {0} {1}r.".replace("{0}",this.getMonthName()).replace("{1}",this.selectedYear),p=o.getStringUnitWidth(l)*o.getFontSize()/o.internal.scaleFactor;o.text(l,(a-p)/2,22);const c=["Imię"];for(let d=1;d<=this.getDaysInMonth();d++)c.push(d.toString());const u=this.people.map(d=>{const h=[d.name];for(let m=1;m<=this.getDaysInMonth();m++){const M=this.getFormattedShift(d.id,m,`
`);h.push(M||"")}return h});e(o,{head:[c],body:u,startY:30,theme:"grid",margin:{left:8},styles:{fontSize:8,cellPadding:3,font:"IBMPlexMono",fontStyle:"normal",lineWidth:.3,minCellHeight:8,halign:"center",cellWidth:"wrap",overflow:"linebreak"},columnStyles:{0:{cellWidth:24}},headStyles:{fillColor:[0,62,62],textColor:[255,255,255],fontSize:6},didParseCell:function(d){try{if(d.section==="head"&&d.row.index===0&&d.column.index>0){const h=parseInt(d.cell.raw.toString());if(!isNaN(h)){const m=new Date(this.selectedYear,this.selectedMonth,h),M=m.getDay(),k=M===6,_=M===0;S(m).isHoliday?(d.cell.styles.fillColor=[255,255,255],d.cell.styles.textColor=[204,0,0]):k?(d.cell.styles.fillColor=[0,153,0],d.cell.styles.textColor=[255,255,255]):_&&(d.cell.styles.fillColor=[204,0,0],d.cell.styles.textColor=[255,255,255])}}else if(d.section==="body"&&(d.row.index%2===1?d.cell.styles.fillColor=[240,240,240]:d.cell.styles.fillColor=[255,255,255],d.column.index>0)){const h=parseInt(d.cell.raw.toString());if(!isNaN(h)){const m=new Date(this.selectedYear,this.selectedMonth,h),M=m.getDay(),k=M===6,_=M===0;S(m).isHoliday?d.cell.styles.fillColor=[255,238,238]:(k||_)&&(d.cell.styles.fillColor=[235,235,235])}}}catch(h){console.error("Error in didParseCell:",h)}}.bind(this),didDrawCell:function(d){try{if(d.section==="head"&&d.row.index===0&&d.column.index>0){const h=parseInt(d.cell.raw.toString());if(!isNaN(h)){const m=new Date(this.selectedYear,this.selectedMonth,h);if(S(m).isHoliday){const{x:k,y:_,width:A}=d.cell;o.setFontSize(6),o.setTextColor(204,0,0),o.text("*",k+A-3,_+3),o.setFontSize(8),o.setTextColor(0,0,0)}}}}catch(h){console.error("Error in didDrawCell:",h)}}.bind(this)});const f=(o.lastAutoTable.finalY||150)+10;o.setFontSize(10),o.setTextColor(0,0,0),o.text("Legenda:",14,f),o.text("D  - Dzienna 07:00-19:00",14,f+6),o.text("N  - Nocna   19:00-07:00",14,f+12),o.text("DN - Doba    07:00-07:00",14,f+18);const D=[];for(let d=1;d<=this.getDaysInMonth();d++){const h=new Date(this.selectedYear,this.selectedMonth,d),m=S(h);m.isHoliday&&D.push({date:h,name:m.name})}D.length!=0&&(o.text("Święta w tym miesiącu:",14,f+28),D.forEach((d,h)=>{o.text(`${d.date.getDate()} - ${d.name}`,14,f+34+h*6)})),o.save(this.getFilename("pdf")),this.showExportMenu=!1,C("Harmonogram zapisany jako PDF","green")}catch(t){console.error("Error exporting PDF:",t),C("Błąd podczas eksportu do PDF","red")}},async exportToExcel(){try{const t=await v(()=>import("./exceljs.min-BF0zIuxs.js").then(l=>l.e),__vite__mapDeps([0,1])),e=new t.Workbook,o=e.addWorksheet(`${this.getMonthName()} ${this.selectedYear}`),a=["Imię"];for(let l=1;l<=this.getDaysInMonth();l++)a.push(l.toString());o.addRow(a);const s=o.getRow(1).eachCell(l=>{l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"003E3E"}},l.font={color:{argb:"FFFFFF"},bold:!0},l.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});this.people.forEach((l,p)=>{const c=[l.name];for(let y=1;y<=this.getDaysInMonth();y++)c.push(this.getFormattedShift(l.id,y," "));o.addRow(c);const u=p+2;u%2===0&&o.getRow(u).eachCell(y=>{y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F0F0F0"}}})});for(let l=1;l<=this.getDaysInMonth();l++){const p=new Date(this.selectedYear,this.selectedMonth,l),{isHoliday:c,name:u}=S(p),y=p.getDay(),f=y===6,D=y===0;if(f||D||c){const h=this.getExcelColumnLetter(l+1);for(let M=2;M<=this.people.length+1;M++){const k=o.getCell(`${h}${M}`);k.fill={type:"pattern",pattern:"solid",fgColor:{argb:c?"FFEEEE":"EEEEEE"}}}const m=o.getCell(`${h}1`);if(c){m.note=u;const M=m.value?.toString()||"";m.value=M+"★",m.font={color:{argb:"FFCC0000"},bold:!0}}else f?(m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"009900"}},m.font={color:{argb:"FFFFFF"},bold:!0}):D&&(m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"CC0000"}},m.font={color:{argb:"FFFFFF"},bold:!0})}}o.columns.forEach(l=>{l.width=12}),o.getColumn(1).width=20,o.getColumn(1).alignment={horizontal:"left"};const n=await e.xlsx.writeBuffer(),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});this.downloadFile(r,this.getFilename("xlsx")),this.showExportMenu=!1,C("Harmonogram zapisany jako Excel","green")}catch(t){console.error("Error exporting Excel:",t),C("Błąd podczas eksportu do Excel","red")}},downloadFile(t,e){const o=document.createElement("a"),a=URL.createObjectURL(t);o.setAttribute("href",a),o.setAttribute("download",e),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},getDaysInMonth(){return new Date(this.selectedYear,this.selectedMonth+1,0).getDate()},getFormattedShift(t,e,o=`
`){const s=new Date(this.selectedYear,this.selectedMonth,e).toDateString(),n=localStorage.getItem(s);if(n){const r=JSON.parse(n),l=[];return(r.dayShift1===t||r.dayShift2===t)&&l.push("D"),(r.nightShift1===t||r.nightShift2===t)&&l.push("N"),l.join(o)}return""},isWeekendOrHoliday(t){const e=new Date(this.selectedYear,this.selectedMonth,t),o=e.getDay();if(o===0||o===6)return!0;const{isHoliday:a}=S(e);return a},getWeekendColumnStyles(){const t={};for(let e=1;e<=this.getDaysInMonth();e++)this.isWeekendOrHoliday(e)&&(t[e]={fillColor:[235,235,235]});return t},getExcelColumnLetter(t){let e=t,o="",a;for(;e>0;)a=(e-1)%26,o=String.fromCharCode(65+a)+o,e=Math.floor((e-a)/26);return o},arrayBufferToBase64(t){let e="";const o=new Uint8Array(t);for(let a=0;a<o.byteLength;a++)e+=String.fromCharCode(o[a]);return window.btoa(e)}}},ne={class:"export-container"};function se(t,e,o,a,s,n){return g(),w("div",ne,[i("button",{class:T(["export-button top-right-buttons",{"excel-position":o.currentPage==="ExcelComponent","calendar-position":o.currentPage==="CalendarComponent"}]),onClick:e[0]||(e[0]=(...r)=>n.toggleExportMenu&&n.toggleExportMenu(...r)),title:"Eksportuj harmonogram","aria-label":"Eksportuj harmonogram"},e[4]||(e[4]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"export-icon"},[i("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),i("polyline",{points:"7 10 12 15 17 10"}),i("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)]),2),s.showExportMenu?(g(),w("div",{key:0,class:T(["export-menu",{"excel-position":o.currentPage==="ExcelComponent","calendar-position":o.currentPage==="CalendarComponent"}])},[i("button",{onClick:e[1]||(e[1]=(...r)=>n.exportToCsv&&n.exportToCsv(...r)),class:"export-option"},e[5]||(e[5]=[B('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-e24a7f24><path d="M14 3v4a1 1 0 0 0 1 1h4" data-v-e24a7f24></path><path d="M17 21H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7l5 5v11a2 2 0 0 1-2 2z" data-v-e24a7f24></path><path d="M9 17h6" data-v-e24a7f24></path><path d="M9 13h6" data-v-e24a7f24></path></svg><span data-v-e24a7f24>CSV</span>',2)])),i("button",{onClick:e[2]||(e[2]=(...r)=>n.exportToExcel&&n.exportToExcel(...r)),class:"export-option"},e[6]||(e[6]=[B('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="lightgreen" stroke-width="2" data-v-e24a7f24><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-e24a7f24></path><polyline points="14 2 14 8 20 8" data-v-e24a7f24></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-e24a7f24></line><line x1="16" y1="17" x2="8" y2="17" data-v-e24a7f24></line><polyline points="10 9 9 9 8 9" data-v-e24a7f24></polyline></svg><span data-v-e24a7f24>Excel (XLSX)</span>',2)])),i("button",{onClick:e[3]||(e[3]=(...r)=>n.exportToPdf&&n.exportToPdf(...r)),class:"export-option"},e[7]||(e[7]=[B('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="pink" stroke-width="2" data-v-e24a7f24><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-e24a7f24></path><polyline points="14 2 14 8 20 8" data-v-e24a7f24></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-e24a7f24></line><line x1="16" y1="17" x2="8" y2="17" data-v-e24a7f24></line><polyline points="10 9 9 9 8 9" data-v-e24a7f24></polyline></svg><span data-v-e24a7f24>PDF</span>',2)]))],2)):E("",!0)])}const re=R(oe,[["render",se],["__scopeId","data-v-e24a7f24"]]),ae={name:"ButtonImport",props:{isEditingMode:{type:Boolean,required:!0},people:{type:Array,required:!0},monthDays:{type:Array,required:!0}},emits:["has-changes","cells-imported"],data(){return{showModal:!1,pastedData:"",parsedData:[],daysMismatch:!1,importedCells:new Set,isDragging:!1}},computed:{daysInMonth(){return this.monthDays.length}},mounted(){this.$nextTick(()=>{this.$refs.dropZone&&this.$refs.dropZone.focus()}),window.addEventListener("paste",this.handleGlobalPaste)},beforeUnmount(){window.removeEventListener("paste",this.handleGlobalPaste)},methods:{showImportModal(){this.showModal=!0,this.resetImport(),this.$nextTick(()=>{this.$refs.dropZone&&this.$refs.dropZone.focus()})},closeImportModal(){this.showModal=!1},resetImport(){this.pastedData="",this.parsedData=[],this.importedCells.clear()},triggerFileInput(){this.$refs.fileInput&&this.$refs.fileInput.click()},onDragOver(t){this.isDragging=!0,t.dataTransfer.dropEffect="copy"},onDragLeave(){this.isDragging=!1},onDrop(t){this.isDragging=!1;const e=t.dataTransfer.files;if(e.length>0)this.handleFileData(e[0]);else{const o=t.dataTransfer.getData("text/html");if(o)this.processHtmlTable(o);else{const a=t.dataTransfer.getData("text/plain");a&&(this.pastedData=a,this.parseImportedData())}}},onPaste(t){const e=t.clipboardData||window.clipboardData,o=e.getData("text/html");if(o){this.processHtmlTable(o);return}const a=e.getData("text/plain");a&&(this.pastedData=a,this.parseImportedData())},handleGlobalPaste(t){this.showModal&&this.onPaste(t)},processHtmlTable(t){try{const a=new DOMParser().parseFromString(t,"text/html").querySelectorAll("table");if(a.length>0){const n=a[0].querySelectorAll("tr");let r="";n.forEach(l=>{const p=l.querySelectorAll("th, td"),c=Array.from(p).map(u=>u.textContent.trim());r+=c.join("	")+`
`}),this.pastedData=r,this.parseImportedData()}}catch(e){console.error("Error processing HTML table:",e),C("Nie udało się przetworzyć tabeli.","red")}},handleFileUpload(t){const e=t.target.files[0];e&&this.handleFileData(e)},handleFileData(t){t.type==="text/csv"||t.name.endsWith(".csv")?this.parseCSVFile(t):t.type.includes("spreadsheetml")||t.name.endsWith(".xlsx")||t.name.endsWith(".xls")?this.parseExcelFile(t):C("Nie wspierany format pliku. Proszę użyć pliku CSV lub Excela.","red")},parseCSVFile(t){const e=new FileReader;e.onload=o=>{this.pastedData=o.target.result,this.parseImportedData()},e.readAsText(t)},async parseExcelFile(t){try{const e=await v(()=>import("./exceljs.min-BF0zIuxs.js").then(s=>s.e),__vite__mapDeps([0,1])),o=new e.Workbook,a=new FileReader;a.onload=async s=>{const n=s.target.result;await o.xlsx.load(n);const r=o.getWorksheet(1);let l="";r.eachRow((p,c)=>{const u=p.values.slice(1);l+=u.join(",")+`
`}),this.pastedData=l,this.parseImportedData()},a.readAsArrayBuffer(t)}catch(e){console.error("Error parsing Excel file:",e),C("Nie udało się przetworzyć pliku Excela.","red")}},parseImportedData(){if(!this.pastedData.trim()){this.parsedData=[];return}try{const t=this.pastedData.trim().split(/\r?\n/).filter(n=>n.trim());if(t.length<2){C("Zły format danych. Musi zawierać wiersz z dniami i kolumnę z członkami zespołu.","orange");return}const e=n=>{const r=[];let l="",p=!1;for(let c=0;c<n.length;c++){const u=n[c];u==='"'?p&&c<n.length-1&&n[c+1]==='"'?(l+='"',c++):p=!p:(u===","||u==="	"||u===";")&&!p?(r.push(l.trim()),l=""):l+=u}return r.push(l.trim()),r},o=t.map(e),a=o[0].slice(1),s=o.slice(1);this.parsedData=s.map(n=>{const r=n[0].replace(/^"(.*)"$/,"$1"),l=n.slice(1).map(p=>{const c=p.replace(/^"(.*)"$/,"$1").toUpperCase().trim();return["D","N","D N","DN"].includes(c)?c==="DN"?"D N":c:""});return{name:r,shifts:l}}),this.parsedData=this.parsedData.filter(n=>n.name),this.daysMismatch=a.length!==this.monthDays.length}catch(t){console.error("Error parsing imported data:",t),C("Nie udało się przetworzyć danych. Proszę sprawdzić format.","red"),this.parsedData=[]}},confirmImport(){if(!this.parsedData.length)return;const t=new Set;this.parsedData.forEach(e=>{const o=this.people.find(a=>a.name.toLowerCase()===e.name.toLowerCase());if(!o){C(`Nie znaleziono osoby o nazwie: ${e.name}`,"orange");return}e.shifts.forEach((a,s)=>{if(s<this.monthDays.length){const n=this.monthDays[s],r=n.date.toDateString();a&&(n.dayShift1===o.id&&(n.dayShift1=null),n.dayShift2===o.id&&(n.dayShift2=null),n.nightShift1===o.id&&(n.nightShift1=null),n.nightShift2===o.id&&(n.nightShift2=null),a.includes("D")&&(n.dayShift1?n.dayShift2||(n.dayShift2=o.id,n.dayShift2Name=o.name):(n.dayShift1=o.id,n.dayShift1Name=o.name)),a.includes("N")&&(n.nightShift1?n.nightShift2||(n.nightShift2=o.id,n.nightShift2Name=o.name):(n.nightShift1=o.id,n.nightShift1Name=o.name)),t.add(r),this.importedCells.add(`${o.id}-${n.date.getDate()}`))}})}),t.forEach(e=>{const o=this.monthDays.find(a=>a.date.toDateString()===e);if(o){const a={dayShift1:o.dayShift1,dayShift2:o.dayShift2,nightShift1:o.nightShift1,nightShift2:o.nightShift2};localStorage.setItem(e,JSON.stringify(a))}}),this.closeImportModal(),C("Import zakończony sukcesem.","green"),this.$emit("has-changes",!0),this.$emit("cells-imported",Array.from(this.importedCells))}}},ie=["disabled"],le={key:0,class:"import-modal"},de={class:"import-modal-content"},ce={class:"import-modal-header"},he={class:"import-content"},pe={key:0,class:"drop-zone-placeholder"},ue={key:0,class:"preview-section"},fe={key:0,class:"warning-message"},me={class:"preview-table-container"},ge={class:"preview-table"},ye={class:"controls"},we={class:"modal-footer"},Ce=["disabled"];function Me(t,e,o,a,s,n){return g(),w(L,null,[i("button",{class:"top-right-buttons import-button",onClick:e[0]||(e[0]=(...r)=>n.showImportModal&&n.showImportModal(...r)),disabled:!o.isEditingMode,title:"Importuj dane do CSV lub Excel","aria-label":"Importuj dane do CSV lub Excel"},e[11]||(e[11]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"22",height:"22",fill:"none",stroke:"currentColor","stroke-width":"2"},[i("path",{d:"M3 14v5a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5M12 3v12M7 8l5-5 5 5"})],-1)]),8,ie),s.showModal?(g(),w("div",le,[i("div",de,[i("div",ce,[e[12]||(e[12]=i("h3",null,"Importowanie Danych",-1)),i("button",{class:"close-button",onClick:e[1]||(e[1]=(...r)=>n.closeImportModal&&n.closeImportModal(...r))},"×")]),i("div",he,[i("div",{class:T(["drop-zone",{"drag-active":s.isDragging,"has-data":s.parsedData.length>0}]),onDragover:e[3]||(e[3]=O((...r)=>n.onDragOver&&n.onDragOver(...r),["prevent"])),onDragleave:e[4]||(e[4]=O((...r)=>n.onDragLeave&&n.onDragLeave(...r),["prevent"])),onDrop:e[5]||(e[5]=O((...r)=>n.onDrop&&n.onDrop(...r),["prevent"])),onPaste:e[6]||(e[6]=(...r)=>n.onPaste&&n.onPaste(...r)),onClick:e[7]||(e[7]=(...r)=>n.triggerFileInput&&n.triggerFileInput(...r)),tabindex:"0",ref:"dropZone"},[s.parsedData.length===0?(g(),w("div",pe,e[13]||(e[13]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"gray","stroke-width":"2"},[i("path",{d:"M19 13v6a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-6M12 3v12M8 7l4-4 4 4"})],-1),i("p",null," Przeciągnij i upuść plik, wklej ze schowka, bądź kliknij aby wybrać plik ",-1),i("p",{class:"sub-text"}," Wspierane formaty: CSV, Excel ( xlsx, xls ) albo tabela ",-1)]))):E("",!0),i("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:e[2]||(e[2]=(...r)=>n.handleFileUpload&&n.handleFileUpload(...r)),accept:".csv,.xlsx,.xls"},null,544)],34),s.parsedData.length>0?(g(),w("div",ue,[e[15]||(e[15]=i("h4",null,"Podgląd importowanego miesiąca",-1)),s.daysMismatch?(g(),w("div",fe," Uwaga: Importowany miesiąc ma "+P(s.parsedData[0].shifts.length)+" dni, a obecnie wybrany ma "+P(n.daysInMonth)+" dni. ",1)):E("",!0),i("div",me,[i("table",ge,[i("thead",null,[i("tr",null,[e[14]||(e[14]=i("th",null,null,-1)),(g(!0),w(L,null,j(s.parsedData[0].shifts,(r,l)=>(g(),w("th",{key:`header-${l}`},P(l+1),1))),128))])]),i("tbody",null,[(g(!0),w(L,null,j(s.parsedData,(r,l)=>(g(),w("tr",{key:`row-${l}`},[i("td",null,P(r.name),1),(g(!0),w(L,null,j(r.shifts,(p,c)=>(g(),w("td",{key:`cell-${l}-${c}`,class:"imported-shift"},P(p),1))),128))]))),128))])])]),i("div",ye,[i("button",{class:"reset-button",onClick:e[8]||(e[8]=(...r)=>n.resetImport&&n.resetImport(...r))},"Reset")])])):E("",!0),i("div",we,[i("button",{class:"cancel-button",onClick:e[9]||(e[9]=(...r)=>n.closeImportModal&&n.closeImportModal(...r))}," Anuluj "),i("button",{class:"import-confirm-button",onClick:e[10]||(e[10]=(...r)=>n.confirmImport&&n.confirmImport(...r)),disabled:!s.parsedData.length}," Importuj ",8,Ce)])])])])):E("",!0)],64)}const ve=R(ae,[["render",Me],["__scopeId","data-v-6c514bdd"]]),De={name:"VueCalendar",components:{SideBarComponent:z(()=>v(()=>import("./SideBarComponent-DTaVJZrM.js"),__vite__mapDeps([2,3,4,5,6]))),MonthSelector:z(()=>v(()=>import("./MonthSelector-B_LtiwB7.js"),__vite__mapDeps([7,3,4,5,8]))),PeopleListWindow:z(()=>v(()=>import("./PeopleListWindow-DacT2nIH.js"),__vite__mapDeps([9,3,4,5,10]))),ShiftCountWindow:z(()=>v(()=>import("./ShiftCountWindow-CaJ_Rlsh.js"),__vite__mapDeps([11,3,4,5,12]))),NotificationMessage:z(()=>v(()=>import("./utils-B-gdOSXq.js").then(t=>t.b),__vite__mapDeps([3,4,5]))),RefreshIcon:$,ButtonExport:re,ButtonImport:ve},data(){return{isEditingMode:this.safeGetFromStorage("isEditingMode",!1),selectedMonth:new Date().getMonth(),selectedYear:new Date().getFullYear(),locale:"pl",hasUnsavedChanges:!1,showPasswordModal:!1,localData:{},people:[{id:1,name:"Milena",ratownik:!1},{id:2,name:"Mikołaj",ratownik:!1},{id:3,name:"Aleksandra",ratownik:!1},{id:4,name:"Łukasz",ratownik:!0},{id:5,name:"Joanna",ratownik:!1},{id:6,name:"Natalia",ratownik:!0},{id:7,name:"Marcin",ratownik:!0}],monthDays:[],isRefreshing:!1,AuthorizationModal:null,CalendarComponent:null,ExcelComponent:null,currentPage:localStorage.getItem("currentPage")||"ExcelComponent"}},methods:{handleNavigation(t){this.hasUnsavedChanges&&!confirm("Masz niezapisane zmiany. Czy na pewno chcesz zmienić widok? Twoje zmiany zostaną utracone.")||(localStorage.setItem("currentPage",t),t==="CalendarComponent"&&!this.CalendarComponent?(this.isLoading=!0,v(()=>import("./CalendarComponent-C89GBL2m.js"),__vite__mapDeps([13,14,3,4,5,15])).then(e=>{this.CalendarComponent=F(e.default),this.currentPage=t,this.hasUnsavedChanges=!1,this.isLoading=!1})):t==="ExcelComponent"&&!this.ExcelComponent?(this.isLoading=!0,v(()=>import("./ExcelComponent-CO52EKUP.js"),__vite__mapDeps([16,14,3,4,5,17])).then(e=>{this.ExcelComponent=F(e.default),this.currentPage=t,this.hasUnsavedChanges=!1,this.isLoading=!1})):(this.currentPage=t,this.hasUnsavedChanges=!1))},handleMonthChange(t){this.selectedMonth+=t,this.selectedMonth>11?(this.selectedMonth=0,this.selectedYear+=1):this.selectedMonth<0&&(this.selectedMonth=11,this.selectedYear-=1)},discardChanges(){this.hasUnsavedChanges=!1,this.checkShiftDataSync()},generateCurrentView(){this.currentPage==="ExcelComponent"&&this.$refs.excelComponent?this.$refs.excelComponent.generateMonthDays():this.currentPage==="CalendarComponent"&&this.$refs.calendarComponent&&this.$refs.calendarComponent.generateMonthDays()},async checkShiftDataSync(){const t=setTimeout(()=>{this.isRefreshing&&(console.warn("Refresh operation timed out"),this.isRefreshing=!1,C("Odświeżanie przerwane - timeout","red"))},6e3);this.isRefreshing=!0;try{const e=q(()=>this.generateCurrentView());this.syncedChanges=await Promise.race([e,new Promise((o,a)=>setTimeout(()=>a(new Error("Sync timeout")),5e3))]),this.hasUnsavedChanges=!1}catch(e){console.error("Error during refresh:",e),C(`Błąd podczas odświeżania: ${e.message||"Unknown error"}`,"red")}finally{clearTimeout(t),setTimeout(()=>{this.isRefreshing=!1},800)}},updateEditingMode(t){this.isEditingMode=t,localStorage.setItem("isEditingMode",JSON.stringify(t))},updateUnsavedChanges(t){this.hasUnsavedChanges=t},showPasswordPrompt(){this.AuthorizationModal?this.showPasswordModal=!0:v(()=>import("./AuthorizationModal-B-Jb3w7K.js"),__vite__mapDeps([18,3,4,5,19])).then(t=>{this.AuthorizationModal=F(t.default),this.showPasswordModal=!0})},handleAuthorization(){this.showPasswordModal=!1,this.hasUnsavedChanges=!1,this.$refs.activeComponent?.handleChangesSaved()},emitEditingMode(t){this.updateEditingMode(t)},enableEditingMode(){this.isEditingMode=!0},updateMonthDays(t){this.monthDays=t},recoverFromError(){this.isRefreshing=!1,this.currentPage==="ExcelComponent"&&!this.$refs.excelComponent&&this.handleNavigation("ExcelComponent"),this.isLoading=!1},safeGetFromStorage(t,e){try{const o=localStorage.getItem(t);return o!==null?JSON.parse(o):e}catch(o){return console.warn(`Error reading ${t} from localStorage:`,o),e}},handleImportedCells(t){if(!this.ExcelComponent){console.error("ExcelComponent is not loaded yet.");return}this.$refs.excelComponent.importedCells=new Set(t)}},async mounted(){try{if(this.isRefreshing=!1,!this.ExcelComponent)try{this.ExcelComponent=F((await v(async()=>{const{default:e}=await import("./ExcelComponent-CO52EKUP.js");return{default:e}},__vite__mapDeps([16,14,3,4,5,17]))).default)}catch(e){console.error("Failed to load Excel component:",e),C("Błąd ładowania Tabeli","red")}if(localStorage.getItem("currentPage")==="CalendarComponent"&&!this.CalendarComponent)try{const e=await v(()=>import("./CalendarComponent-C89GBL2m.js"),__vite__mapDeps([13,14,3,4,5,15]));this.CalendarComponent=F(e.default)}catch(e){console.error("Failed to load Calendar component:",e),C("Błąd ładowania Kalendarza","red"),this.currentPage="ExcelComponent",localStorage.setItem("currentPage","ExcelComponent")}this.discardChanges(),this.hasUnsavedChanges=!1}catch(t){console.error("Error during application initialization:",t),C("Błąd inicjalizacji aplikacji","red")}window.addEventListener("error",t=>{console.error("Global error caught:",t.error),this.recoverFromError()}),window.addEventListener("unhandledrejection",t=>{console.error("Unhandled promise rejection:",t.reason),this.recoverFromError()})},computed:{peopleListEditingMode(){switch(this.currentPage){case"CalendarComponent":return this.isEditingMode;case"ExcelComponent":return!1;default:return!1}}}},Ee={class:"app-container"},xe=["disabled"],be={class:"top-right-buttons-container"},ke={class:"top-right-buttons compact-toggle",title:"Przełącz tryb edytowania"},Se=["checked"],_e=["aria-checked"],Pe={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round",class:"pencil-icon"},ze={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round",class:"pencil-icon"},Ie={class:"main-content"},Fe={key:0,class:"refresh-overlay"},Le={style:{display:"flex","flex-direction":"column","align-items":"center"}},Ne={class:"editing-mode-label"},Te={class:"editing-mode-label"};function Re(t,e,o,a,s,n){const r=x("SideBarComponent"),l=x("MonthSelector"),p=x("refresh-icon"),c=x("ButtonExport"),u=x("ButtonImport"),y=x("RefreshIcon"),f=x("PeopleListWindow"),D=x("ShiftCountWindow"),d=x("NotificationMessage");return g(),w(L,null,[i("div",Ee,[s.AuthorizationModal&&s.showPasswordModal?(g(),N(W(s.AuthorizationModal),{key:0,show:s.showPasswordModal,onClose:e[0]||(e[0]=h=>s.showPasswordModal=!1),onAuthorized:n.handleAuthorization,"aria-label":"Zapisz zmiany",title:"Zapisz zmiany w harmonogramie",mode:"save"},null,40,["show","onAuthorized"])):E("",!0),i("button",{disabled:!s.hasUnsavedChanges,onClick:e[1]||(e[1]=(...h)=>n.showPasswordPrompt&&n.showPasswordPrompt(...h)),class:"submit-button","aria-label":"Zapisz zmiany",title:"Zapisz zmiany w harmonogramie"}," Zapisz ",8,xe),b(r,{currentComponent:s.currentPage,onNavigate:n.handleNavigation},null,8,["currentComponent","onNavigate"]),b(l,{currentMonth:s.selectedMonth,currentYear:s.selectedYear,locale:s.locale,hasUnsavedChanges:s.hasUnsavedChanges,onChangeMonth:n.handleMonthChange,onDiscardChanges:n.discardChanges},null,8,["currentMonth","currentYear","locale","hasUnsavedChanges","onChangeMonth","onDiscardChanges"]),i("section",be,[i("button",{class:"top-right-buttons buttonRefresh",onClick:e[2]||(e[2]=h=>n.checkShiftDataSync()),"aria-label":"Odśwież harmonogram",title:"Odśwież harmonogram"},[b(p,{class:T({refreshing:s.isRefreshing})},null,8,["class"])]),i("label",ke,[i("input",{type:"checkbox",checked:s.isEditingMode,onChange:e[3]||(e[3]=h=>n.emitEditingMode(h.target.checked)),"aria-label":"Przełącz tryb edytowania"},null,40,Se),i("span",{class:"slider",role:"switch","aria-checked":s.isEditingMode},[s.isEditingMode?(g(),w("svg",ze,e[5]||(e[5]=[i("path",{d:"M12 20h9"},null,-1),i("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"},null,-1)]))):(g(),w("svg",Pe,e[4]||(e[4]=[i("path",{d:"M12 20h9"},null,-1),i("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"},null,-1)])))],8,_e)]),b(c,{people:s.people,monthDays:s.monthDays,selectedMonth:s.selectedMonth,selectedYear:s.selectedYear,currentPage:s.currentPage},null,8,["people","monthDays","selectedMonth","selectedYear","currentPage"]),b(u,{isEditingMode:s.isEditingMode,people:s.people,monthDays:s.monthDays,onHasChanges:n.updateUnsavedChanges,onCellsImported:n.handleImportedCells},null,8,["isEditingMode","people","monthDays","onHasChanges","onCellsImported"])]),i("main",Ie,[s.isRefreshing?(g(),w("div",Fe,[b(y,{class:"centered-refresh-icon refreshing"})])):E("",!0),i("div",{style:H({opacity:s.isRefreshing?"0.5":"1"})},[s.currentPage==="CalendarComponent"?(g(),N(W(s.CalendarComponent),{key:0,ref:"calendarComponent",isEditingMode:s.isEditingMode,selectedMonth:s.selectedMonth,selectedYear:s.selectedYear,people:s.people,onUpdateEditingMode:n.updateEditingMode,onHasChanges:n.updateUnsavedChanges,onMonthDaysUpdated:n.updateMonthDays},null,40,["isEditingMode","selectedMonth","selectedYear","people","onUpdateEditingMode","onHasChanges","onMonthDaysUpdated"])):E("",!0),s.currentPage==="ExcelComponent"?(g(),N(W(s.ExcelComponent),{key:1,ref:"excelComponent",isEditingMode:s.isEditingMode,selectedMonth:s.selectedMonth,selectedYear:s.selectedYear,people:s.people,onUpdateEditingMode:n.updateEditingMode,onHasChanges:n.updateUnsavedChanges,onMonthDaysUpdated:n.updateMonthDays},null,40,["isEditingMode","selectedMonth","selectedYear","people","onUpdateEditingMode","onHasChanges","onMonthDaysUpdated"])):E("",!0)],4),b(f,{people:s.people,isEditingMode:n.peopleListEditingMode},null,8,["people","isEditingMode"]),U(i("div",Le,[U(i("h1",Ne,e[6]||(e[6]=[I(" Tryb edytowania "),i("a",{style:{color:"#4caf50"}},"Włączony",-1),i("br",null,null,-1),I(" Przeciągaj członków zespołu na miejsca w grafiku."),i("br",null,null,-1),I("Kliknij na zajętą zmianę, aby ją wyczyścić. ")]),512),[[Y,s.currentPage==="CalendarComponent"]]),U(i("h1",Te,e[7]||(e[7]=[I(" Tryb edytowania "),i("a",{style:{color:"#4caf50"}},"Włączony",-1),i("br",null,null,-1),I(" Kliknij na miejsce w tabeli, aby wybrać zmianę. ")]),512),[[Y,s.currentPage==="ExcelComponent"]])],512),[[Y,s.isEditingMode]]),s.monthDays.length>0&&s.localData[1]!==null?(g(),N(D,{key:1,ref:"shiftCountWindow",people:s.people,monthDays:s.monthDays},null,8,["people","monthDays"])):E("",!0),b(d)])]),e[8]||(e[8]=i("footer",{class:"footer"},[i("a",{href:"https://github.com/puksh/kalendar"},"© 2025 puksh - All rights reserved")],-1))],64)}const Ae=R(De,[["render",Re],["__scopeId","data-v-6d552bae"]]);window.addEventListener("error",t=>{t.error&&(t.error.message.includes("Failed to fetch dynamically imported module")||t.error.message.includes("Importing a module script failed"))&&window.location.reload()});Z(Ae).mount("#app");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(t=>{console.log("Service Worker registered with scope:",t.scope)}).catch(t=>{console.log("Service Worker registration failed:",t)})});export{v as _,S as i};
