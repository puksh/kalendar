import{_ as l,j as c,a as s,o as u,b as h,d as n,g as p,k as w,e as y}from"./index-CrFS8m9F.js";const m={name:"AuthorizationModal",props:{show:{type:Boolean,required:!0},localData:{type:Object,required:!0}},emits:["close","authorized"],data(){return{password:""}},methods:{async authorize(){if(c.MD5(this.password).toString()==="71d114fc94f6a0badc14cf88cb4b8d98")try{const o=await this.encodeLargeData(this.localData);if(!o){console.error("Failed to encode data"),s("Brak zakodowanych danych","red");return}if(!(await fetch("https://mc.kot.li/?key=shiftData.json",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"shiftData",value:o})})).ok)throw new Error("Nie udało się zaktualizować danych na serwerze");s("Zmiany zapisano!","green"),this.$emit("authorized")}catch(o){console.error("Error updating server data:",o),s(o.message||"Nie udało się zaktualizować danych","red")}else s("Złe hasło","red"),console.error("Incorrect password entered");this.closeModal()},closeModal(){this.password="",this.$emit("close")},async encodeLargeData(i){try{localStorage.removeItem("isEditingMode");const e=JSON.stringify(i,null,2),o=new Blob([e],{type:"application/json"}),a=new FileReader,d=await new Promise((r,t)=>{a.onloadend=()=>{r(a.result.split(",")[1])},a.onerror=()=>t(new Error("Failed to read the Blob")),a.readAsDataURL(o)});return localStorage.setItem("isEditingMode",JSON.stringify(!0)),d}catch(e){return console.error("Error encoding large data:",e),s("Nie udało się zakodować danych","red"),localStorage.setItem("isEditingMode",JSON.stringify(!0)),null}},cancel(){this.closeModal()}}},f={key:0,class:"modal"},g={class:"modal-content"};function z(i,e,o,a,d,r){return o.show?(u(),h("section",f,[n("div",g,[e[3]||(e[3]=n("p",null,"Wpisz hasło:",-1)),p(n("input",{type:"password","onUpdate:modelValue":e[0]||(e[0]=t=>d.password=t)},null,512),[[w,d.password]]),n("button",{onClick:e[1]||(e[1]=(...t)=>r.authorize&&r.authorize(...t))},"Zapisz"),n("button",{onClick:e[2]||(e[2]=(...t)=>r.cancel&&r.cancel(...t))},"Anuluj")])])):y("",!0)}const b=l(m,[["render",z],["__scopeId","data-v-0afe4de4"]]);export{b as default};
