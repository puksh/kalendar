const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pbkdf2-Dyyg270d.js","assets/crypto-vendor-x_riFVyO.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-BvuVA5b7.js";import{N as k,a as l,_}from"./utils-ILKzS2sg.js";import{c as u,e as y,o as c,d as t,k as P,u as A,x as v,n as f,t as S}from"./vue-vendor-CVTALk6y.js";const j={name:"AuthorizationModal",props:{show:{type:Boolean,required:!0}},emits:["close","authorized"],components:{NotificationMessage:k},data(){return{password:"",isAuthorizing:!1,showPassword:!1}},methods:{async authorize(){if(!this.isAuthorizing){this.isAuthorizing=!0,this.showPassword=!1;try{const d=await b(()=>import("./pbkdf2-Dyyg270d.js").then(a=>a.p),__vite__mapDeps([0,1])),s="asmmRrfFvKrsBgyLzUuiZD9tGQj3LAQj",h=1e5,w=256/32;if(d.default(this.password,s,{keySize:w,iterations:h}).toString()!=="5fb04c8d929f687dd2baed132f66d67a8a442cab4d2d84cec4a58b08f01f9c6b"){l("Nieprawidłowe hasło","red"),this.password="",this.isAuthorizing=!1;return}const o={};for(let a=0;a<localStorage.length;a++){const r=localStorage.key(a);if(r!=="isEditingMode"&&r!=="currentPage")try{o[r]=JSON.parse(localStorage.getItem(r))}catch{}}if(Object.keys(o).length===0){l("Brak zmian do zapisania","yellow"),this.isAuthorizing=!1;return}const g=JSON.stringify(o),m=new Blob([g],{type:"application/json"}),n=new FileReader,z=await new Promise((a,r)=>{n.onloadend=()=>a(n.result.toString().split(",")[1]),n.onerror=r,n.readAsDataURL(m)}),p=await fetch("https://mc.kot.li/?key=shiftData.json",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"shiftData",value:z})});if(!p.ok)throw new Error(`Server error: ${p.status}`);l("Zmiany zapisano pomyślnie!","green"),this.$emit("authorized"),this.closeModal()}catch{l("Nie udało się zaktualizować danych","red")}finally{this.isAuthorizing=!1}}},closeModal(){this.password="",this.$emit("close")},cancel(){this.isAuthorizing||this.closeModal()},togglePasswordVisibility(){this.showPassword=!this.showPassword}},mounted(){this.$nextTick(()=>{this.$refs.passwordInput?.focus()})}},x={key:0,class:"modal"},D={class:"modal-content"},N={class:"input-container"},B=["type"],M=["aria-label","title"],C={class:"eye-icon"},V={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"22",height:"22",fill:"none",stroke:"white","stroke-width":"2"},K={class:"button-container"},U=["disabled"],E={key:0,class:"spinner"},I=["disabled"];function O(d,s,h,w,e,i){return h.show?(c(),u("section",x,[t("div",D,[s[6]||(s[6]=t("h3",null,"Autoryzacja",-1)),s[7]||(s[7]=t("p",null,"Wpisz hasło aby zapisać zmiany:",-1)),t("div",N,[P(t("input",{type:e.showPassword?"text":"password","onUpdate:modelValue":s[0]||(s[0]=o=>e.password=o),onKeyup:s[1]||(s[1]=v((...o)=>i.authorize&&i.authorize(...o),["enter"])),placeholder:"Hasło...",autocomplete:"current-password",ref:"passwordInput"},null,40,B),[[A,e.password]]),t("button",{type:"button",class:"toggle-password-button",onClick:s[2]||(s[2]=(...o)=>i.togglePasswordVisibility&&i.togglePasswordVisibility(...o)),"aria-label":e.showPassword?"Ukryj hasło":"Pokaż hasło",title:e.showPassword?"Ukryj hasło":"Pokaż hasło"},[t("span",C,[(c(),u("svg",V,[t("g",{class:f({"eye-hidden":!e.showPassword})},s[5]||(s[5]=[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),t("circle",{cx:"12",cy:"12",r:"3"},null,-1)]),2),t("line",{class:f(["eye-slash",{"eye-slash-hidden":e.showPassword}]),x1:"2",y1:"2",x2:"22",y2:"22"},null,2)]))])],8,M)]),t("div",K,[t("button",{class:"primary-button",onClick:s[3]||(s[3]=(...o)=>i.authorize&&i.authorize(...o)),disabled:e.isAuthorizing},[t("span",null,S(e.isAuthorizing?"Weryfikacja...":"Zapisz"),1),e.isAuthorizing?(c(),u("span",E)):y("",!0)],8,U),t("button",{class:"secondary-button",onClick:s[4]||(s[4]=(...o)=>i.cancel&&i.cancel(...o)),disabled:e.isAuthorizing}," Anuluj ",8,I)])])])):y("",!0)}const F=_(j,[["render",O],["__scopeId","data-v-fda89984"]]);export{F as default};
